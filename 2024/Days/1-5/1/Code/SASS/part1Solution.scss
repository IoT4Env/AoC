@use "sass:string";
@use "sass:map";
@use 'sass:list';
@use 'sass:math';

//One-liner input text
$input1: "<your_input>";

//Global means that they are not immutable and content might change during code execution
$column1-global: ();
$column2-global: ();


@function extract_columns($rows){
    $column1: ();
    $column2: ();
    @each $row in $rows{
        $values: string.split($row, " ");
        $first-value-found: 0;
        @each $value in $values{
            @if $value != "" and $first-value-found == 0 {
                $first-value-found: 1;
                $number: str-to-int($value);
                $column1: list.append($column1, $number);
            }@else if $value != ""{//Second column value
                $number: str-to-int($value);
                $column2: list.append($column2, $number);
            }
        }
    }
    @return ("column1": $column1, "column2": $column2);
}

@function str-to-int($str){
    // Matrices
    // Used to convert string to numbers
    $strings: '0' '1' '2' '3' '4' '5' '6' '7' '8' '9';
    $numbers: 0 1 2 3 4 5 6 7 8 9;
    $result: 0;

    // Looping through all characters
    @for $i from 1 through string.length($str) {
        $character: string.slice($str, $i, $i);
        $index: list.index($strings, $character);

        $number: list.nth($numbers, $index);
        $result: $result * 10 + $number;
    }

    @return $result;
}


@function list-sort($list){
    $len: list.length($list);

    $i: 1;
    @while $i < $len {
        $j: $i + 1;
        @while list.nth($list, $i) > list.nth($list, $j){
            $temp: list.nth($list, $i);
            $list: list.set-nth($list, $i, list.nth($list, $j));
            $list: list.set-nth($list, $j, $temp);

            $i: $i - 1;
            $j: $j - 1;
            
            @if $i <= 0{
                $i: 1;
                $j: 2;
            }
        }
        $i: $i + 1;
    }
    
    @return $list;
}

@function get-difference($list1, $list2){
    $difference: 0;

    @for $i from 1 through list.length($list1){
        $difference: $difference + abs(list.nth($list1, $i) - list.nth($list2, $i));
    }

    @return $difference;
}

@function number-to-hex($number){
    $hex-mapping: 'A' 'B' 'C' 'D' 'E' 'F';

    $hex: "";

    @while $number != 0{
        $remainder: $number % 16;
        $number: math.floor(math.div($number, 16));

        @if $remainder > 9{
            $remainder: list.nth($hex-mapping, $remainder - 9);
        }

        $hex: $remainder + $hex;
    }

    //Adjust hex value to fit color hex
    $len: string.length($hex);

    //Add zeros at thge begininng until 6 digits in length
    @while $len < 6{
        $hex: '0' + $hex;
        $len: string.length($hex);
    }

    //Requires alpha, thus creating a 8 digit hex value
    @if $len == 7{
        $hex: $hex + '0';
    }
    
    @return $hex;
}


.part-one .solution{
    $rows: string.split($input1, "|");
    
    $matrix: extract_columns($rows);
    
    $column1-global: list-sort(map.get($matrix, "column1"));
    $column2-global: list-sort(map.get($matrix, "column2"));
    $difference: get-difference($column1-global, $column2-global);
    
    $hex-difference: number-to-hex($difference);
    background-color: string.unquote('#' + $hex-difference);
    width: 50px;
    height: 50px;
}
